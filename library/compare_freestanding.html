<!DOCTYPE html>
<html>

<title>D1855R0: Make &lt;compare&gt; freestanding</title>
<style type="text/css">
  p {text-align:justify}
  li {text-align:justify}
  blockquote.note
  {
    background-color:#E0E0E0;
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 1px;
    padding-bottom: 1px;
  }
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
  table {border-collapse: collapse;}
</style>
<body>
<h1>Make &lt;compare&gt; freestanding</h1>
Document number: D1855R0<br/>
Date: TODO<br/>
Reply-to: Ben Craig &lt;ben dot craig at gmail dot com&gt;<br/>
Audience: Library Evolution Working Group

<h1>The problem</h1>
<p>
In Cologne, <a href="https://wg21.link/p1614r2">the mothership landed</a> and <code>&lt;coroutine&gt;</code> got updated to use op&lt=&gt;.  <code>&lt;coroutine&gt;</code> is a <a href="https://wg21.link/compliance">freestanding header</a>.  <code>&lt;compare&gt;</code> isnâ€™t listed as freestanding.
</p><p>
Pedantically, <code>&lt;coroutine&gt;</code> is part of the implementation, so it can do whatever it wants.  If the user wants to compare <code>coroutine_handle</code>s, then I think they need to include <code>&lt;compare&gt;</code> <a href="https://wg21.link/expr.spaceship#10">[expr.spaceship]</a>.
</p><p>
So we should add <code>&lt;compare&gt;</code> to freestanding to resolve the issue.  This follows the C++98 - C++20 design precedent of having core language support in the freestanding library.
</p>
<h1>Proposed resolution:</h1>
<p>This wording is relative to <a href="https://wg21.link/n4830">N4830</a>.</p>

<ol>
<li><p>In 16.5.1.3 <a href="https://wg21.link/compliance">[compliance]</a>, add a new row to
<a href="https://wg21.link/compliance#tab:headers.cpp.fs">Table 22</a>:</p>

<blockquote>
<table style="border: 1px solid black">
<caption>Table 22 &mdash; C++ headers for freestanding implementations</caption>
<thead>
<tr style="border: 1px solid black">
<th colspan="2" style="text-align: center">Subclause</th><th style="text-align: center">Header(s)</th>
</tr>
</thead>
<tbody>
<tr style="border: 1px solid black">
<td style="padding: 0ex 1ex 0ex 1ex">[&hellip;]</td>
<td style="padding: 0ex 1ex 0ex 1ex">[&hellip;]</td>
<td style="padding: 0ex 1ex 0ex 1ex">[&hellip;]</td>
</tr>
<tr style="border: 1px solid black">
<td style="padding: 0ex 1ex 0ex 1ex">17.10 <a href="https://wg21.link/support.initlist">[support.initlist]</a></td>
<td style="padding: 0ex 1ex 0ex 1ex">Initializer lists</td>
<td style="padding: 0ex 1ex 0ex 1ex"><tt>&lt;initializer_list&gt;</tt></td>
</tr>
<tr style="border: 1px solid black">
<td style="padding: 0ex 1ex 0ex 1ex"><ins>17.11 <a href="https://wg21.link/cmp">[cmp]</a></ins></td>
<td style="padding: 0ex 1ex 0ex 1ex"><ins>Comparisons</ins></td>
<td style="padding: 0ex 1ex 0ex 1ex"><ins><tt>&lt;compare&gt;</tt></ins></td>
</tr>
<tr style="border: 1px solid black">
<td style="padding: 0ex 1ex 0ex 1ex">17.12 <a href="https://wg21.link/support.coroutine">[support.cooutine]</a></td>
<td style="padding: 0ex 1ex 0ex 1ex">Coroutines support</td>
<td style="padding: 0ex 1ex 0ex 1ex"><tt>&lt;coroutine&gt;</tt></td>
</tr>
<tr style="border: 1px solid black">
<td style="padding: 0ex 1ex 0ex 1ex">[&hellip;]</td>
<td style="padding: 0ex 1ex 0ex 1ex">[&hellip;]</td>
<td style="padding: 0ex 1ex 0ex 1ex">[&hellip;]</td>
</tr>
</tbody>
</table>

</blockquote>
</li>
</ol>

</body>
